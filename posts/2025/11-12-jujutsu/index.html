<!doctype html>
<html prefix="og: http://ogp.me/ns#">
<head>
    <title>Git 的痛點到未來：Jujutsu (jj)</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

  <meta property="og:site_name" content="Simply Patrick"/>
  <meta property="og:url" content="https://blog.simplypatrick.com/posts/2025/11-12-jujutsu/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="https://lh3.googleusercontent.com/-GqbL2_hPq9Y/UC9brHyHa1I/AAAAAAAAEoY/rGGtCNWe3Vw/s800/patrick.jpg"/>

  <link rel="preload" href="/fonts/Arvo-Regular.ttf" as="font" type="font/ttf" crossorigin>
<link rel="preload" href="/fonts/Julee-Regular.ttf" as="font" type="font/ttf" crossorigin>
<link rel="preload" href="/fonts/JustMeAgainDownHere-Regular.ttf" as="font" type="font/ttf" crossorigin>
<link rel="preload" href="/fonts/SourceCodePro-Regular.ttf" as="font" type="font/ttf" crossorigin>
<link rel="preload" href="/fonts/NotoSansTC-Regular.ttf" as="font" type="font/ttf" crossorigin>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/bootstrap-toc.css" rel="stylesheet">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

<link href="/css/prism.css" rel="stylesheet" />
<link href="/css/blog.css" rel="stylesheet">

<link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" />

  <meta property="og:site_name" content="Simply Patrick"/>
  <meta property="og:url" content="https://blog.simplypatrick.com/posts/2025/11-12-jujutsu/"/>
  <meta property="og:title" content="Git 的痛點到未來：Jujutsu (jj)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:article:published_time" content="2025-11-11 17:11:34 -0800 -0800"/>
  
  <meta property="og:article:tag" content="vcs"/>
  
  <meta property="og:article:tag" content="ai-assisted"/>
  
  <meta property="og:article:author" content="Patrick Tsai"/>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container" id="main">
    <div class="row">
      <header role="banner">
  <div class="row">
    <div class="col-md-9">
      <h1 class="banner-title">
        <a href="/">Simply Patrick</a>
        <small class="banner-subtitle">Hopes can always go up, tears can only come down.</small>
      </h1>
    </div>
    <div class="col-md-3 text-right">
      <ul class="social-links list-inline">
        <li><a href="https://twitter.com/PatrickSimply"><i class="fa fa-twitter"></i></a></li>
        <li><a href="https://www.facebook.com/yinghau76"><i class="fa fa-facebook"></i></a></li>
        <li><a href="https://www.linkedin.com/in/yinghau76"><i class="fa fa-linkedin"></i></a></li>
        <li><a href="https://github.com/p47t"><i class="fa fa-github-alt"></i></a></li>
      </ul>
    </div>
  <div>
</header>

      <nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/posts/">posts</a>
      <a class="navbar-brand" href="/tils/">TILs</a>
    </div>

    
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">categories <b class="caret"></b></a>
          <ul class="dropdown-menu">
          
            <li><a href="/categories/ai">ai <span class="badge">1</span></a></li>
          
            <li><a href="/categories/ai-assisted">ai-assisted <span class="badge">2</span></a></li>
          
            <li><a href="/categories/blog">blog <span class="badge">3</span></a></li>
          
            <li><a href="/categories/business">business <span class="badge">26</span></a></li>
          
            <li><a href="/categories/career">career <span class="badge">20</span></a></li>
          
            <li><a href="/categories/claude-code">claude-code <span class="badge">1</span></a></li>
          
            <li><a href="/categories/development">development <span class="badge">52</span></a></li>
          
            <li><a href="/categories/ffi">ffi <span class="badge">1</span></a></li>
          
            <li><a href="/categories/game">game <span class="badge">3</span></a></li>
          
            <li><a href="/categories/programming">programming <span class="badge">205</span></a></li>
          
            <li><a href="/categories/rust">rust <span class="badge">1</span></a></li>
          
            <li><a href="/categories/web">web <span class="badge">10</span></a></li>
          
            <li><a href="/categories/%e7%a1%ac%e9%ab%94">硬體 <span class="badge">1</span></a></li>
          
            <li><a href="/categories/%e9%96%8b%e7%99%bc%e5%b7%a5%e5%85%b7">開發工具 <span class="badge">1</span></a></li>
          
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">tags <b class="caret"></b></a>
          <ul class="dropdown-menu">
          
            <li><a href="/tags/agent">agent <span class="badge">4</span></a></li>
          
            <li><a href="/tags/agile">agile <span class="badge">4</span></a></li>
          
            <li><a href="/tags/ai">ai <span class="badge">2</span></a></li>
          
            <li><a href="/tags/ai-assisted">ai-assisted <span class="badge">13</span></a></li>
          
            <li><a href="/tags/android">android <span class="badge">14</span></a></li>
          
            <li><a href="/tags/async">async <span class="badge">2</span></a></li>
          
            <li><a href="/tags/audio">audio <span class="badge">1</span></a></li>
          
            <li><a href="/tags/ble">ble <span class="badge">1</span></a></li>
          
            <li><a href="/tags/book">book <span class="badge">25</span></a></li>
          
            <li><a href="/tags/build">build <span class="badge">4</span></a></li>
          
            <li><a href="/tags/build-tools">build-tools <span class="badge">1</span></a></li>
          
            <li><a href="/tags/builder">builder <span class="badge">1</span></a></li>
          
            <li><a href="/tags/c&#43;&#43;">c&#43;&#43; <span class="badge">8</span></a></li>
          
            <li><a href="/tags/cargo-apk">cargo-apk <span class="badge">1</span></a></li>
          
            <li><a href="/tags/claude">claude <span class="badge">1</span></a></li>
          
            <li><a href="/tags/claude-code">claude-code <span class="badge">4</span></a></li>
          
            <li><a href="/tags/cli">cli <span class="badge">2</span></a></li>
          
            <li><a href="/tags/cloud">cloud <span class="badge">1</span></a></li>
          
            <li><a href="/tags/codex">codex <span class="badge">1</span></a></li>
          
            <li><a href="/tags/crack">crack <span class="badge">2</span></a></li>
          
            <li><a href="/tags/derive">derive <span class="badge">1</span></a></li>
          
            <li><a href="/tags/design-patterns">design-patterns <span class="badge">4</span></a></li>
          
            <li><a href="/tags/dotnet">dotnet <span class="badge">42</span></a></li>
          
            <li><a href="/tags/dsp">dsp <span class="badge">1</span></a></li>
          
            <li><a href="/tags/embedded">embedded <span class="badge">5</span></a></li>
          
            <li><a href="/tags/engineer">engineer <span class="badge">2</span></a></li>
          
            <li><a href="/tags/ffi">ffi <span class="badge">1</span></a></li>
          
            <li><a href="/tags/ffmpeg">ffmpeg <span class="badge">1</span></a></li>
          
            <li><a href="/tags/font">font <span class="badge">3</span></a></li>
          
            <li><a href="/tags/fuchsia">fuchsia <span class="badge">2</span></a></li>
          
            <li><a href="/tags/futures">futures <span class="badge">2</span></a></li>
          
            <li><a href="/tags/game">game <span class="badge">2</span></a></li>
          
            <li><a href="/tags/git">git <span class="badge">5</span></a></li>
          
            <li><a href="/tags/go">go <span class="badge">5</span></a></li>
          
            <li><a href="/tags/google">google <span class="badge">5</span></a></li>
          
            <li><a href="/tags/gpu">gpu <span class="badge">1</span></a></li>
          
            <li><a href="/tags/gpui">gpui <span class="badge">2</span></a></li>
          
            <li><a href="/tags/gradle">gradle <span class="badge">1</span></a></li>
          
            <li><a href="/tags/gui">gui <span class="badge">4</span></a></li>
          
            <li><a href="/tags/hdr">hdr <span class="badge">1</span></a></li>
          
            <li><a href="/tags/iced">iced <span class="badge">2</span></a></li>
          
            <li><a href="/tags/image-processing">image-processing <span class="badge">2</span></a></li>
          
            <li><a href="/tags/ios">ios <span class="badge">6</span></a></li>
          
            <li><a href="/tags/java">java <span class="badge">9</span></a></li>
          
            <li><a href="/tags/jpeg">jpeg <span class="badge">1</span></a></li>
          
            <li><a href="/tags/jupyter">jupyter <span class="badge">1</span></a></li>
          
            <li><a href="/tags/keyboard">keyboard <span class="badge">1</span></a></li>
          
            <li><a href="/tags/kotlin">kotlin <span class="badge">2</span></a></li>
          
            <li><a href="/tags/kuso">kuso <span class="badge">3</span></a></li>
          
            <li><a href="/tags/management">management <span class="badge">3</span></a></li>
          
            <li><a href="/tags/markdown">markdown <span class="badge">1</span></a></li>
          
            <li><a href="/tags/mechanical-keyboard">mechanical-keyboard <span class="badge">1</span></a></li>
          
            <li><a href="/tags/microsoft">microsoft <span class="badge">14</span></a></li>
          
            <li><a href="/tags/ndk">ndk <span class="badge">1</span></a></li>
          
            <li><a href="/tags/octopress">octopress <span class="badge">3</span></a></li>
          
            <li><a href="/tags/ortholinear">ortholinear <span class="badge">1</span></a></li>
          
            <li><a href="/tags/osx">osx <span class="badge">4</span></a></li>
          
            <li><a href="/tags/parser">parser <span class="badge">1</span></a></li>
          
            <li><a href="/tags/patterns">patterns <span class="badge">4</span></a></li>
          
            <li><a href="/tags/peacock">peacock <span class="badge">1</span></a></li>
          
            <li><a href="/tags/proc-macro">proc-macro <span class="badge">1</span></a></li>
          
            <li><a href="/tags/process">process <span class="badge">2</span></a></li>
          
            <li><a href="/tags/productivity">productivity <span class="badge">1</span></a></li>
          
            <li><a href="/tags/qmk">qmk <span class="badge">1</span></a></li>
          
            <li><a href="/tags/ruby">ruby <span class="badge">15</span></a></li>
          
            <li><a href="/tags/rust">rust <span class="badge">23</span></a></li>
          
            <li><a href="/tags/scala">scala <span class="badge">3</span></a></li>
          
            <li><a href="/tags/shader">shader <span class="badge">1</span></a></li>
          
            <li><a href="/tags/slint">slint <span class="badge">1</span></a></li>
          
            <li><a href="/tags/spaced-repetition">spaced-repetition <span class="badge">1</span></a></li>
          
            <li><a href="/tags/startup">startup <span class="badge">3</span></a></li>
          
            <li><a href="/tags/swift">swift <span class="badge">1</span></a></li>
          
            <li><a href="/tags/traits">traits <span class="badge">1</span></a></li>
          
            <li><a href="/tags/tui">tui <span class="badge">1</span></a></li>
          
            <li><a href="/tags/ultrahdr">ultrahdr <span class="badge">2</span></a></li>
          
            <li><a href="/tags/vcs">vcs <span class="badge">3</span></a></li>
          
            <li><a href="/tags/vibe-coding">vibe-coding <span class="badge">1</span></a></li>
          
            <li><a href="/tags/vscode">vscode <span class="badge">1</span></a></li>
          
            <li><a href="/tags/wasm">wasm <span class="badge">5</span></a></li>
          
            <li><a href="/tags/web">web <span class="badge">3</span></a></li>
          
            <li><a href="/tags/webassembly">webassembly <span class="badge">3</span></a></li>
          
            <li><a href="/tags/webgpu">webgpu <span class="badge">1</span></a></li>
          
            <li><a href="/tags/webkit">webkit <span class="badge">3</span></a></li>
          
            <li><a href="/tags/wgpu">wgpu <span class="badge">1</span></a></li>
          
            <li><a href="/tags/windows">windows <span class="badge">5</span></a></li>
          
            <li><a href="/tags/work">work <span class="badge">11</span></a></li>
          
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">series <b class="caret"></b></a>
          <ul class="dropdown-menu">
          
            <li><a href="/series/fuchsia-dev">fuchsia dev <span class="badge">2</span></a></li>
          
            <li><a href="/series/modern-c&#43;&#43;">modern c&#43;&#43; <span class="badge">2</span></a></li>
          
            <li><a href="/series/rust-52-projects">rust-52-projects <span class="badge">11</span></a></li>
          
            <li><a href="/series/zeroclaw">zeroclaw <span class="badge">4</span></a></li>
          
          </ul>
        </li>
      </ul>
      <form class="navbar-form navbar-left" role="search" action="/search/" method="get">
        <div class="form-group">
          <input class="form-control" type="text" name="q" results="0" placeholder="search"/>
        </div>
        <button type="submit" class="btn btn-default">submit</button>
      </form>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/pages/about">about</a></li>
      </ul>
    </div>
  </div>
</nav>

    </div>

  <div class="row">
    <div class="col-md-9" data-pagefind-body>
          <div class="row">
      <div class="col-xs-6">
        
        <section id="prev" class="text-left">
          <a class="previous" href="https://blog.simplypatrick.com/posts/2025/11-11-jujutsu/">
            <span class="glyphicon glyphicon-circle-arrow-left"></span>
            版本控制的個人效率追尋
          </a>
        </section>
        
      </div>
      <div class="col-xs-6">
        
        <section id="next" class="text-right">
          <a class="next" href="https://blog.simplypatrick.com/posts/2025/11-20-gemini-3-pro/">
            試用 Gemini 3 Pro
            <span class="glyphicon glyphicon-circle-arrow-right"></span>
          </a>
        </section>
        
      </div>
    </div>
      <h2 class="post-title">Git 的痛點到未來：Jujutsu (jj)</h2>
      <div class="post-meta">
        <span class="post-date">November 11, 2025</span>
        
        <a href="/categories/programming"><span class="label label-info">programming</span></a>
        
        
        <a href="/tags/vcs"><span class="label label-primary">vcs</span></a>
        
        <a href="/tags/ai-assisted"><span class="label label-primary">ai-assisted</span></a>
        
        

      </div>
      <div class="post-content">
        <blockquote>
<p><strong>AI 生成聲明：</strong> 本文初稿由 Gemini 2.5 Flash AI 生成, 再由個人手動修改而成。</p>
</blockquote>
<p>Git 改變了世界，但也留下了無數「分支地獄」的故事。今天，我們將從兩個被低估的 Git 外掛工具開始，一步步引導你走向一個更現代、更人性化的版本控制未來 —— <strong>Jujutsu (jj)</strong>。</p>
<hr>
<h2 id="引言git-的輝煌與隱憂">引言：Git 的輝煌與隱憂</h2>
<p>你是否曾經：</p>
<ul>
<li>為了改一個 typo，敲了 <code>git rebase -i HEAD~5</code>，然後工作目錄瞬間爆炸？</li>
<li>在 10 個依賴分支之間切來切去，忘記自己正在做什麼？</li>
<li>看著 <code>git log</code> 像聖誕樹一樣亂七八糟，卻無從下手？</li>
</ul>
<p>Git 無疑是偉大的，但它的設計來自 2005 年。那個年代沒有 stacked diff、沒有 PR stack、沒有即時 CI。<br>
今天，我們需要的不只是「能用」，而是「好用」。</p>
<p>這篇文章將帶你走過一條<strong>進化之路</strong>：</p>

  <div class="mermaid">
    graph LR
    A[git-revise] --> B[git-branchstack] --> C[Jujutsu]
    style C fill:#6c5ce7,stroke:#333,color:#fff
    style A fill:#fab1a0
    style B fill:#fdcb6e
  </div>

<p>從小修小補，到系統性革新。</p>
<hr>
<h2 id="第一站git-revise--讓歷史編輯不再破壞">第一站：<code>git-revise</code> —— 讓歷史編輯不再「破壞」</h2>
<h3 id="問題git-rebase-的副作用">問題：<code>git rebase</code> 的副作用</h3>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git rebase -i HEAD~3
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 衝突！工作目錄被打斷，stash 忘記了，崩潰中...</span></span></span></code></pre></div>

<p><code>rebase</code> 雖然能重寫歷史，但它會<strong>強制中斷你的工作流</strong>。</p>

  <div class="mermaid">
    graph TD
    subgraph "Git rebase 問題"
        A[工作目錄] --> B[rebase 開始]
        B --> C[衝突中斷]
        C --> D[stash / reset]
        D --> A
    end
    style C fill:#e17055,stroke:#333,color:#fff
  </div>

<p><em>圖1：傳統 <code>git rebase</code> 常導致工作流循環中斷</em></p>
<hr>
<h3 id="解法git-revise">解法：<code>git-revise</code></h3>
<p><code>git-revise</code> 是 Git 的子命令，專注於<strong>非破壞性提交編輯</strong>。它在記憶體中操作，<strong>不影響工作目錄</strong>。</p>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 安裝</span>
</span></span><span style="display:flex;"><span>pipx install git-revise
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 修復最近一個 commit 的拼字錯誤</span>
</span></span><span style="display:flex;"><span>git revise -m <span style="color:#e6db74">&#34;Fix typo in login button&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 分割最後一個大 commit 成兩個小塊</span>
</span></span><span style="display:flex;"><span>git revise --split</span></span></code></pre></div>


  <div class="mermaid">
    graph LR
    subgraph "git-revise 流程"
        A[記憶體中編輯] --> B[更新 commit]
        B --> C[工作目錄不變]
        C --> A
    end
    style B fill:#00b894,color:#fff
  </div>

<p><em>圖2：<code>git-revise</code> 在記憶體中安全編輯，工作流不中斷</em></p>
<blockquote>
<p><strong>靈感來源</strong>：<code>git-revise</code> 是 jj 創始人 <strong>Martin von Zweigbergk</strong> 早期作品之一。</p>
</blockquote>
<p>它讓「修補歷史」從痛苦變成愉悅，但它只解決了<strong>單點問題</strong>。分支管理呢？還是一團亂。</p>
<hr>
<h2 id="第二站git-branchstack--分支堆疊的魔法">第二站：<code>git-branchstack</code> —— 分支堆疊的魔法</h2>
<h3 id="問題分支依賴地獄">問題：分支依賴地獄</h3>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 手動流程</span>
</span></span><span style="display:flex;"><span>git checkout main
</span></span><span style="display:flex;"><span>git checkout -b feature/login
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ... coding ...</span>
</span></span><span style="display:flex;"><span>git checkout -b feature/login-validation  <span style="color:#75715e"># 依賴 login</span>
</span></span><span style="display:flex;"><span>git checkout feature/login
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 切來切去，build 重跑，頭暈</span></span></span></code></pre></div>

<p>在團隊使用 <strong>stacked diff</strong>（如 Gerrit、Phabricator）時，這種切換簡直是災難。</p>

  <div class="mermaid">
    graph TD
    A[main] --> B[feature/login]
    B --> C[feature/login-validation]
    C --> B
    B --> D[feature/other]
    style B fill:#fd79a8
    style C fill:#fd79a8
    style D fill:#fd79a8
  </div>

<p><em>圖3：傳統 Git 分支切換形成雜亂的依賴網</em></p>
<hr>
<h3 id="解法git-branchstack">解法：<code>git-branchstack</code></h3>
<p>這是一個<strong>輕量級堆疊分支管理器</strong>，核心概念：</p>
<blockquote>
<p><strong>用 commit message 的 <code>[topic]</code> tag 自動建立分支堆疊</strong></p>
</blockquote>
<h4 id="安裝">安裝</h4>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pipx install git-branchstack
</span></span><span style="display:flex;"><span>pipx install git-revise  <span style="color:#75715e"># 建議一起用</span></span></span></code></pre></div>

<h4 id="實戰範例">實戰範例</h4>
<p>假設你在 <code>local-dev</code> 分支上有 3 個 commits：</p>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 用 git-revise 加上 topic tags</span>
</span></span><span style="display:flex;"><span>git revise --interactive --edit</span></span></code></pre></div>

<p>編輯後的 commit message：</p>

  <pre tabindex="0"><code>[auth] Add login endpoint
[auth] Validate JWT token
[ui] Update login button style</code></pre>

<p>執行：</p>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git branchstack</span></span></code></pre></div>


  <div class="mermaid">
    gitGraph
   commit id: "main"
   branch auth
   checkout auth
   commit id: "Add login"
   commit id: "Validate JWT"
   branch ui
   checkout ui
   commit id: "Update button"
  </div>

<p><em>圖4：<code>git branchstack</code> 自動建立清晰的堆疊結構</em></p>
<h4 id="推送整個堆疊">推送整個堆疊</h4>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 設定 alias 更方便</span>
</span></span><span style="display:flex;"><span>git config alias.bspush <span style="color:#e6db74">&#39;!git push -u origin $(git branchstack --list-local)&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>git bspush</span></span></code></pre></div>

<blockquote>
<p>來源：<a href="https://github.com/krobelus/git-branchstack">git-branchstack GitHub</a></p>
</blockquote>
<p>它讓「分支堆疊」從手動變成自動，但它仍是 <strong>Git 的外掛</strong>，無法改變核心體驗。</p>
<hr>
<h2 id="高潮jujutsu-jj--版本控制的未來已來">高潮：Jujutsu (jj) —— 版本控制的未來已來</h2>
<blockquote>
<p><strong>jj = git-revise 的靈魂 + git-branchstack 的堆疊 + Git 的相容性 + 全新設計</strong></p>
</blockquote>
<p>由 Google 工程師 <strong>Martin von Zweigbergk</strong> 開發，jj 已在 Google 內部逐步取代舊 VCS。</p>
<h3 id="核心創新對比">核心創新對比</h3>
<table>
  <thead>
      <tr>
          <th>概念</th>
          <th>Git</th>
          <th>jj</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>提交單位</td>
          <td>不可變 commit</td>
          <td><strong>可變 change</strong></td>
      </tr>
      <tr>
          <td>歷史追蹤</td>
          <td>線性 log</td>
          <td><strong>操作日誌 (operation log)</strong></td>
      </tr>
      <tr>
          <td>分支管理</td>
          <td>手動切換</td>
          <td><strong>自動書籤 + 堆疊</strong></td>
      </tr>
      <tr>
          <td>衝突處理</td>
          <td>手動</td>
          <td><strong>內建多方解析器</strong></td>
      </tr>
      <tr>
          <td>相容性</td>
          <td>-</td>
          <td><strong>100% Git 互通</strong></td>
      </tr>
  </tbody>
</table>

  <div class="mermaid">
    graph LR
    subgraph "jj 核心模型"
        C[Change] --> O[Operation Log]
        C --> B[Bookmarks]
        B --> G[Git 互通]
    end
    style C fill:#6c5ce7,color:#fff
  </div>

<p><em>圖5：jj 的 changes + bookmarks + operation log 核心架構</em></p>
<hr>
<h3 id="關鍵特性一changes-而非-commits">關鍵特性一：<strong>Changes 而非 Commits</strong></h3>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># jj：提交是「活的」</span>
</span></span><span style="display:flex;"><span>jj new               <span style="color:#75715e"># 創建新 change</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;fix&#34;</span> &gt;&gt; file   <span style="color:#75715e"># 修改</span>
</span></span><span style="display:flex;"><span>jj amend             <span style="color:#75715e"># 更新當前 change（像 git amend）</span>
</span></span><span style="display:flex;"><span>jj split             <span style="color:#75715e"># 輕鬆分割 change</span></span></span></code></pre></div>


  <div class="mermaid">
    graph LR
    A[原始 change] --> B[jj amend]
    B --> C[更新後 change]
    C --> A
    style B fill:#00b894,color:#fff
  </div>

<p><em>圖6：<code>jj amend</code> 即時更新 change，無需 rebase</em></p>
<blockquote>
<p>所有操作都在記憶體中，<strong>不中斷工作流</strong>。</p>
</blockquote>
<hr>
<h3 id="關鍵特性二操作日誌-operation-log">關鍵特性二：<strong>操作日誌 (Operation Log)</strong></h3>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jj op log</span></span></code></pre></div>


  <pre tabindex="0"><code>@  abc123  2分鐘前  new change
├─ def456  5分鐘前  amend change
├─ ghi789  10分鐘前 rebase -d main</code></pre>


  <div class="mermaid">
    graph TD
    A[rebase -d main] --> B[amend change]
    B --> C[new change]
    style C fill:#6c5ce7,color:#fff
  </div>

<p><em>圖7：<code>jj op log</code> 提供完整操作歷史，永不迷路</em></p>
<p>你永遠知道「系統怎麼變成這樣的」。</p>
<hr>
<h3 id="關鍵特性三自動堆疊書籤進階版">關鍵特性三：<strong>自動堆疊書籤（進階版）</strong></h3>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 從 main 開始</span>
</span></span><span style="display:flex;"><span>jj new main -m <span style="color:#e6db74">&#34;[auth] Add login&#34;</span>
</span></span><span style="display:flex;"><span>jj bookmark create auth   <span style="color:#75715e"># 手動標記（僅此一次）</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 繼續堆疊</span>
</span></span><span style="display:flex;"><span>jj new -m <span style="color:#e6db74">&#34;[ui] Update button&#34;</span>
</span></span><span style="display:flex;"><span>jj bookmark create ui     <span style="color:#75715e"># 標記上層</span></span></span></code></pre></div>

<p><strong>jj log 顯示</strong>：</p>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ jj log
</span></span><span style="display:flex;"><span>@  ooo  <span style="color:#f92672">[</span>ui<span style="color:#f92672">]</span> Update login button
</span></span><span style="display:flex;"><span>│  │   <span style="color:#f92672">(</span>你正在編輯<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>├─ ooo  <span style="color:#f92672">[</span>auth<span style="color:#f92672">]</span> Add login endpoint
</span></span><span style="display:flex;"><span>│  │
</span></span><span style="display:flex;"><span>○──○──○ main</span></span></code></pre></div>


  <div class="mermaid">
    gitGraph
   commit id: "main"
   branch auth
   checkout auth
   commit id: "Add login"
   branch ui
   checkout ui
   commit id: "Update button"
   checkout main
  </div>

<p><em>圖8：<code>jj log</code> 內建堆疊視覺化，無需額外工具</em></p>
<blockquote>
<p><strong>小提醒</strong>：bookmark 需手動 <code>create</code>，但一旦建立，後續 <code>amend</code>/<code>rebase</code> 會<strong>自動移動上層</strong>，無需手動調整。</p>
</blockquote>
<h4 id="推送整個堆疊-1">推送整個堆疊</h4>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jj git push --all-bookmarks</span></span></code></pre></div>

<hr>
<h3 id="對比git-vs-jj-的-rebase">對比：Git vs jj 的 rebase</h3>
<table>
  <thead>
      <tr>
          <th>動作</th>
          <th>Git</th>
          <th>jj</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>重新基於 main</td>
          <td><code>git rebase main</code></td>
          <td><code>jj rebase -d main</code></td>
      </tr>
      <tr>
          <td>工作目錄中斷？</td>
          <td>是</td>
          <td>否</td>
      </tr>
      <tr>
          <td>歷史可回溯？</td>
          <td>靠 reflog</td>
          <td>內建 op log</td>
      </tr>
      <tr>
          <td>分支堆疊保留？</td>
          <td>手動</td>
          <td>自動</td>
      </tr>
  </tbody>
</table>

  <div class="mermaid">
    graph LR
    subgraph "Git rebase"
        G1[main] --> G2[feature]
        G2 --> G3[rebase 後]
        style G3 fill:#e17055
    end
    subgraph "jj rebase"
        J1[main] --> J2[auth]
        J2 --> J3[ui]
        J3 --> J4[自動調整]
        style J4 fill:#00b894,color:#fff
    end
  </div>

<p><em>圖9：jj rebase 自動調整堆疊，Git 需手動修補</em></p>
<hr>
<h2 id="實戰30-秒上手-jj">實戰：30 秒上手 jj</h2>

  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 安裝（需要 Rust）</span>
</span></span><span style="display:flex;"><span>cargo install jj
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 從現有 Git repo 啟動</span>
</span></span><span style="display:flex;"><span>cd my-project
</span></span><span style="display:flex;"><span>jj git init
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 開始使用</span>
</span></span><span style="display:flex;"><span>jj log
</span></span><span style="display:flex;"><span>jj new -m <span style="color:#e6db74">&#34;fix typo&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;hello&#34;</span> &gt;&gt; file
</span></span><span style="display:flex;"><span>jj amend
</span></span><span style="display:flex;"><span>jj git push</span></span></code></pre></div>


  <div class="mermaid">
    graph TD
    A[安裝 jj] --> B[初始化 repo]
    B --> C[開始使用]
    C --> D[無痛 amend]
    style D fill:#6c5ce7,color:#fff
  </div>

<p><em>圖10：從 Git 遷移到 jj 的 3 步流程</em></p>
<blockquote>
<p>官方文檔：<a href="https://github.com/jj-vcs/jj">github.com/jj-vcs/jj</a></p>
</blockquote>
<hr>
<h2 id="結論擁抱進化別讓工具綁住你">結論：擁抱進化，別讓工具綁住你</h2>
<table>
  <thead>
      <tr>
          <th>工具</th>
          <th>定位</th>
          <th>適合對象</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>git-revise</code></td>
          <td>局部修補</td>
          <td>想提升 rebase 體驗</td>
      </tr>
      <tr>
          <td><code>git-branchstack</code></td>
          <td>堆疊管理</td>
          <td>stacked diff 團隊</td>
      </tr>
      <tr>
          <td><strong>Jujutsu (jj)</strong></td>
          <td>全面替代</td>
          <td>追求未來 VCS 的人</td>
      </tr>
  </tbody>
</table>

  <div class="mermaid">
    graph TD
    A[痛苦的 Git 日常] --> B[嘗試 git-revise]
    B --> C[愛上 git-branchstack]
    C --> D[擁抱 Jujutsu]
    style D fill:#6c5ce7,stroke:#333,color:#fff
  </div>

<p>從 <code>git-revise</code> 的小修小補，到 <code>git-branchstack</code> 的分支魔法，<strong>jj 將這些碎片融為一體</strong>，開啟版本控制的新紀元。</p>
<blockquote>
<p><strong>下次 <code>rebase</code> 讓你崩潰時，試試 <code>jj</code>。</strong></p>
</blockquote>
<p>你不會想回去的。</p>
<hr>
<p><strong>行動呼籲</strong>：</p>
<ol>
<li>現在就試試：<code>cargo install jj</code></li>
<li>從你的 Git repo 匯入：<code>jj git init</code></li>
<li>留言分享你的第一個 <code>jj amend</code> 體驗！</li>
</ol>
<hr>
<p><em>本文作者使用 jj 撰寫，無 rebase 崩潰，僅有快樂。</em></p>

      </div>

      <hr>
      <script src="https://utteranc.es/client.js"
        repo="p47t/p47t.github.io"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


    </div>
    <div class="col-md-3">
      <aside class="toc">
        






<nav id="toc" data-toggle="toc">
  
  <ul class="nav">
  </ul>
</nav>

      </aside>
    </div>
  </div>
    </div>

    <div class="row">
    <div class="col-md-12">
      <footer id="footer" class="text-center">
        © Patrick Tsai 2003-2026.
        Proudly powered by <a href="http://gohugo.io/">Hugo</a>.
      </footer>
    </div>
  </div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  <script src="/js/bootstrap-toc.min.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-73968064-1', 'auto');
  ga('send', 'pageview');

</script>


  <script src="/js/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({ startOnLoad: true });
  </script>

</body>
</html>
